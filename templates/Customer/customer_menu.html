<!DOCTYPE html>

<html lang="en">

  <head>

    <meta charset="UTF-8" />

    <title>Customer Dashboard</title>

    <style>

      body {

        font-family: Arial, sans-serif;

        background: #f5f5f5;

        margin: 0;

        padding: 20px;

      }

      nav {

        text-align: right;

        margin-bottom: 20px;

      }

      .summary-box {

        background-color: #f8f9fa;

        border-radius: 5px;

        padding: 15px;

        margin-bottom: 20px;

        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);

      }

      .restaurant-list {

        list-style-type: none;

        padding: 0;

      }

      .restaurant-item {

        margin-bottom: 15px;

        padding: 15px;

        background-color: #fff;

        border-radius: 5px;

        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);

      }

      .restaurant-item h4 {

        margin: 0;

        display: inline-block;

      }

      .restaurant-item .view-menu {

        float: right;

      }

      .restaurant-stats {

        margin-top: 8px;

        font-size: 14px;

        color: #555;

      }

      .stat-value {

        font-weight: bold;

        color: #28a745;

      }

      button {

        background: #28a745;

        color: white;

        border: none;

        padding: 8px 12px;

        border-radius: 4px;

        cursor: pointer;

      }

      button:hover {

        background: #218838;

      }

      a {

        text-decoration: none;

      }

    </style>

  </head>

  <body>

    <nav>

      <form method="post" action="{{ url_for('logout') }}" style="display: inline">

        <button type="submit">Log Out</button>

      </form>

    </nav>



    <h2>Welcome, {{ username }}!</h2>



    <div class="summary-box">

      <details style="margin-bottom: 10px;">

        <summary><strong>My Addresses</strong></summary>

        {% if addresses and addresses|length > 0 %}

          <ul>

            {% for addr in addresses %}

              <li><strong>{{ addr[0] }}</strong>: {{ addr[1] }}, {{ addr[2] }}</li>

            {% endfor %}

          </ul>

        {% else %}

          <p>No addresses saved.</p>

        {% endif %}

      </details>



      <details style="margin-bottom: 10px;">

        <summary><strong>My Phone Numbers</strong></summary>

        {% if phones and phones|length > 0 %}

          <ul>

            {% for phone in phones %}

              <li>{{ phone[0] }}</li>

            {% endfor %}

          </ul>

        {% else %}

          <p>No phone numbers saved.</p>

        {% endif %}

      </details>



      <a href="{{ url_for('add_address_form') }}"><button>Add Address</button></a>

      <a href="{{ url_for('add_phone_form') }}"><button>Add Phone Number</button></a>

    </div>



    <a href="{{ url_for('view_cart') }}">

      <button>üõí View Cart</button>

    </a>

    <form method="get" action="{{ url_for('customer_menu') }}" style="margin-bottom: 20px;">

      <input

        type="text"

        name="search"

        placeholder="Search by restaurant name or keyword"

        value="{{ request.args.get('search', '') }}"

        style="padding: 5px; width: 300px;"

      />

      <button type="submit">üîç Search</button>

    </form>



    <h3>Restaurants in Your City (Sorted by Rating):</h3>

    {% if restaurants %}

      <ul class="restaurant-list">

        {% for restaurant in restaurants %}

          <li class="restaurant-item">

            <h4>{{ restaurant[1] }}</h4>

            <a class="view-menu" href="{{ url_for('customer_restaurant_page', restaurant_id=restaurant[0]) }}">

              <button>View Menu</button>

            </a>

            <p>City: {{ restaurant[2] }}</p>

            <div class="restaurant-stats">

              Average Rating:

              {% if restaurant[3] is not none %}

                <span class="stat-value">{{ "%.1f"|format(restaurant[3]) }}/5</span>

              {% else %}

                <span class="stat-value">N/A</span>

              {% endif %}

            </div>

          </li>

        {% endfor %}

      </ul>

    {% else %}

      <p>No restaurants found in your city.</p>

    {% endif %}

  </body>

</html>
